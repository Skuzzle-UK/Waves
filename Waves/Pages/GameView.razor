@using RazorConsole.Components
@using System.Diagnostics
@using Waves.Core.Enums

<Panel Border="Spectre.Console.BoxBorder.Double" BorderColor="Spectre.Console.Color.DarkSeaGreen">
    <Grid>
        <Align Horizontal="@Spectre.Console.HorizontalAlignment.Left">
            <Markup Foreground="_healthBarColour" Content="@GetHealthBar()" />

        </Align>
        <Align Horizontal="@Spectre.Console.HorizontalAlignment.Right">
            <Markup Content="@($"{GameManager.Score} : SCORE")" />
        </Align>
    </Grid>
</Panel>

@{
    string? content = GetRenderedContent();
    string[]? lines = content.Split(new[] { "\r\n", "\n" }, StringSplitOptions.None);
}

@if (GameManager.CurrentGameState == GameStates.COUNTDOWN)
{
    <Align Vertical="@Spectre.Console.VerticalAlignment.Middle">
        <Figlet Content="@_countdownText" Color="@Spectre.Console.Color.Cyan1" />
    </Align>
}
else if (GameManager.CurrentGameState == GameStates.GAME_OVER)
{
    <GameOverView Score="@GameManager.Score" OnRestart="RestartGame" OnMainMenu="ReturnToMainMenu" />
}
else if (GameManager.CurrentGameState == GameStates.PAUSED)
{
    <PauseMenuView OnResume="ResumeGame" OnMainMenu="ReturnToMainMenu" OnQuit="ExitApplication" />
}
else
{
    @foreach (string? line in lines)
    {
        string displayLine = TrimLineToWidth(line, 116);
        <Markup Content="@displayLine" />
    }
}

<Markup Content="@_bottomBorder" Foreground="@Spectre.Console.Color.Grey50" />